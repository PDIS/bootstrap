.sidebar {
  .sidebar-header {
    @extend .title-text-lg;
    margin-bottom: 1rem;
  }

  .sidebar-body {
    @extend .label-text-lg;
    padding: 1rem;
    background: var(--surface);
    list-style: none;
    border-radius: 0.625rem;

    .sidebar-subheader {
      @extend .label-text;
      display: block;
      margin-bottom: 0.5rem;
      padding: 0.375rem 0.75rem;
    }

    .sidebar-link {
      @extend .label-text-lg;
      display: block;
      padding: 0.75rem;
      align-items: center;
      width: 100%;
      text-align: left;
      overflow-anchor: none;
      border-radius: 0.5rem;
      background: var(--surface);
      color: var(--on-background);
      text-decoration: none;
      margin-bottom: 0.5rem;

      &:hover {
        background: var(--surface-1);
      }
      
      &:focus-visible, &:active {
        color: var(--on-accent-flat);
        background-color: var(--accent-flat);
      }

      &.active {
        color: var(--on-accent-flat);
        background-color: var(--accent-flat);

        &:hover {
          color: var(--on-accent-flat);
          background: var(--accent-flat-strong);
        }
        
        &:focus-visible, &:active {
          color: var(--on-accent);
          background-color: var(--accent);
        }
      }

    }
  
    .sidebar-button {
      @extend .label-text-lg;
      padding: 0.75rem;
      position: relative;
      display: flex;
      align-items: center;
      width: 100%;
      text-align: left;
      border: 0;
      overflow-anchor: none;
      border-radius: 0.5rem;
      background: var(--surface);
      color: var(--on-background);
      margin-bottom: 0.5rem;

      &:hover {
        background: var(--surface-1);
      }

      &::after { 
        color: var(--on-background);
        content: "\F279"; /* Chevron down */
        font-family: "bootstrap-icons";
        text-align: center;
        margin-left: auto;
      }
  
      &:not(.collapsed) {
        color: var(--on-brand-flat);
        margin-bottom: 0;

        &:hover {
          background: var(--surface-1);
        }

        &:focus-visible, &:active {
          background-color: var(--surface-2);
        }

        &::after { 
          color: var(--on-background);
          content: "\F27C"; /* Chevron down */
          font-family: "bootstrap-icons";
          text-align: center;
          margin-left: auto;
        }
      }
    }

    .sidebar-menu {
      list-style: none;
      padding-left: 0;
      margin-bottom: 0.5rem;

      li {
        position: relative;

        .sidebar-link {
          padding-left: 1.75rem;
          margin-bottom: 0;

          &::before {
            content: '';
            width: auto;
            height: 100%;
            border-left: 2px solid var(--surface-variant);
            position: absolute;
            margin-left: 1rem;
            top: 0;
            left: 0;
          }

          
          &:focus-visible, &:active {
            &::before {
              border-left: 2px solid var(--on-surface-variant);
            }
          }

          &.active {
            &::before {
              content: '';
              width: auto;
              height: 100%;
              border-left: 2px solid var(--on-surface-variant);
              position: absolute;
              margin-left: 1rem;
              top: 0;
              left: 0;
            }

            &:hover {
              &::before {
                border-left: 2px solid var(--on-surface-variant);
              }
            }

            &:focus-visible, &:active {
              &::before {
                border-left: 2px solid var(--on-accent);
              }
            }
          }
        }
  
        .sidebar-button {
          padding-left: 1.75rem;
          margin-bottom: 0;

          &::before {
            content: '';
            width: auto;
            height: 100%;
            border-left: 2px solid var(--surface-variant);
            position: absolute;
            margin-left: 1rem;
            top: 0;
            left: 0;

            &:focus-visible, &:active {
              border-left: 2px solid var(--on-surface-variant);
            }
          }
        }
      }

      .sidebar-menu {
        li {
          .sidebar-link {
            padding-left: 2.625rem;
            margin-bottom: 0;

            &::before {
              border: 0;

              &:focus-visible, &:active {
                &::before {
                  border-left: 0;
                }
              }
            }

            &.active {
              &::before {
                border-left: 0;
              }

              &:hover {
                &::before {
                  border-left: 0;
                }
              }

              &:focus-visible, &:active {
                &::before {
                  border-left: 0;
                }
              }
            }
            
          }
    
          .sidebar-button {
            padding-left: 2.625rem;
            margin-bottom: 0;

            &::before {
              border: 0;
            }
          }
        }
      }
    }
    .sidebar-divider {
      padding: 0.75rem;
      margin: 0.5rem 0;

      hr {
        color: var(--outline);
        margin: 0;
        opacity: 0.6;
      }
    }
  }
}
